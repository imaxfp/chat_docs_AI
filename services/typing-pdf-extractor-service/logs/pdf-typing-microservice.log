2026-01-07 17:26:11,268 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-07 17:44:21,023 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-07 17:45:46,559 - api-server - INFO - Processing request for: test1/drylab.pdf
2026-01-07 17:45:46,561 - pdf-processor - INFO - Downloading drylab.pdf from bucket test1...
2026-01-07 17:45:46,595 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/drylab.pdf
2026-01-07 17:45:46,608 - persistence-service - INFO - Persisting data for drylab.pdf from bucket test1...
2026-01-07 17:45:46,637 - persistence-service - INFO - Successfully persisted PDF bed6973e-a929-4c2e-baa0-0894fc8ea0ab with 15 chunks.
2026-01-07 17:45:46,638 - api-server - INFO - Processing request for: test1/drylab.pdf
2026-01-07 17:45:46,638 - pdf-processor - INFO - Downloading drylab.pdf from bucket test1...
2026-01-07 17:45:46,644 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/drylab.pdf
2026-01-07 17:45:46,647 - persistence-service - INFO - Persisting data for drylab.pdf from bucket test1...
2026-01-07 17:45:46,680 - persistence-service - INFO - Successfully persisted PDF bed6973e-a929-4c2e-baa0-0894fc8ea0ab with 15 chunks.
2026-01-07 17:45:46,681 - api-server - INFO - Processing request for: test1/example.pdf
2026-01-07 17:45:46,681 - pdf-processor - INFO - Downloading example.pdf from bucket test1...
2026-01-07 17:45:46,698 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/example.pdf
2026-01-07 17:45:46,719 - persistence-service - INFO - Persisting data for example.pdf from bucket test1...
2026-01-07 17:45:46,741 - persistence-service - INFO - Successfully persisted PDF 470e4a7e-1060-457e-9aae-407346ce1d9b with 17 chunks.
2026-01-07 17:45:46,742 - api-server - INFO - Processing request for: test1/example.pdf
2026-01-07 17:45:46,743 - pdf-processor - INFO - Downloading example.pdf from bucket test1...
2026-01-07 17:45:46,746 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/example.pdf
2026-01-07 17:45:46,762 - persistence-service - INFO - Persisting data for example.pdf from bucket test1...
2026-01-07 17:45:46,796 - persistence-service - INFO - Successfully persisted PDF 470e4a7e-1060-457e-9aae-407346ce1d9b with 17 chunks.
2026-01-07 17:45:46,797 - api-server - INFO - Processing request for: test1/statements_04.09.23.pdf
2026-01-07 17:45:46,797 - pdf-processor - INFO - Downloading statements_04.09.23.pdf from bucket test1...
2026-01-07 17:45:46,800 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/statements_04.09.23.pdf
2026-01-07 17:45:46,805 - persistence-service - INFO - Persisting data for statements_04.09.23.pdf from bucket test1...
2026-01-07 17:45:46,822 - persistence-service - INFO - Successfully persisted PDF 256d92ed-2182-416a-8d59-6fda71835fda with 6 chunks.
2026-01-07 17:45:46,823 - api-server - INFO - Processing request for: test1/statements_04.09.23.pdf
2026-01-07 17:45:46,824 - pdf-processor - INFO - Downloading statements_04.09.23.pdf from bucket test1...
2026-01-07 17:45:46,826 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/statements_04.09.23.pdf
2026-01-07 17:45:46,830 - persistence-service - INFO - Persisting data for statements_04.09.23.pdf from bucket test1...
2026-01-07 17:45:46,843 - persistence-service - INFO - Successfully persisted PDF 256d92ed-2182-416a-8d59-6fda71835fda with 6 chunks.
2026-01-07 18:02:12,651 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-07 18:11:31,836 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-07 18:11:31,837 - pdf-processor - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-07 18:11:35,466 - pdf-processor - INFO - Initializing Qdrant client at qdrant:6333
2026-01-07 18:11:35,559 - pdf-processor - INFO - Creating Qdrant collection: pdf_chunks
2026-01-07 18:11:46,025 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-07 18:11:46,025 - pdf-processor - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-07 18:11:48,359 - pdf-processor - INFO - Initializing Qdrant client at qdrant:6333
2026-01-07 18:12:03,814 - api-server - INFO - Processing request for: test1/statements_04.09.23.pdf
2026-01-07 18:12:03,815 - pdf-processor - INFO - Downloading statements_04.09.23.pdf from bucket test1...
2026-01-07 18:12:03,838 - pdf-processor - ERROR - Processing failed for test1/statements_04.09.23.pdf: name 'fitz' is not defined
2026-01-07 18:12:03,838 - api-server - ERROR - Internal server error: name 'fitz' is not defined
Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 161, in process_pdf
    with fitz.open(temp_pdf) as doc:
NameError: name 'fitz' is not defined
2026-01-07 18:13:05,249 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-07 18:13:05,250 - pdf-processor - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-07 18:13:07,529 - pdf-processor - INFO - Initializing Qdrant client at qdrant:6333
2026-01-07 18:13:22,874 - api-server - INFO - Processing request for: test1/statements_04.09.23.pdf
2026-01-07 18:13:22,875 - pdf-processor - INFO - Downloading statements_04.09.23.pdf from bucket test1...
2026-01-07 18:13:22,894 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/statements_04.09.23.pdf
2026-01-07 18:13:22,905 - persistence-service - INFO - Persisting data for statements_04.09.23.pdf from bucket test1...
2026-01-07 18:13:22,955 - persistence-service - INFO - Successfully persisted PDF 256d92ed-2182-416a-8d59-6fda71835fda with 6 chunks.
2026-01-07 18:13:22,955 - pdf-processor - INFO - Generating embeddings for 6 chunks...
2026-01-07 18:13:23,649 - pdf-processor - INFO - Upserting 6 points to Qdrant for PDF 256d92ed-2182-416a-8d59-6fda71835fda...
2026-01-07 18:16:14,909 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-07 18:16:14,909 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-07 18:16:17,326 - vector-persistence - INFO - Initializing Qdrant client at qdrant:6333
2026-01-07 18:16:32,534 - api-server - INFO - Processing request for: test1/statements_04.09.23.pdf
2026-01-07 18:16:32,536 - pdf-processor - INFO - Downloading statements_04.09.23.pdf from bucket test1...
2026-01-07 18:16:32,559 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/statements_04.09.23.pdf
2026-01-07 18:16:32,568 - persistence-service - INFO - Persisting data for statements_04.09.23.pdf from bucket test1...
2026-01-07 18:16:32,592 - persistence-service - INFO - Successfully persisted PDF 256d92ed-2182-416a-8d59-6fda71835fda with 6 chunks.
2026-01-07 18:16:32,592 - vector-persistence - INFO - Generating embeddings for 6 chunks...
2026-01-07 18:16:33,179 - vector-persistence - INFO - Upserting 6 points to Qdrant for PDF 256d92ed-2182-416a-8d59-6fda71835fda...
2026-01-07 18:28:07,281 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-07 18:28:07,282 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-07 18:28:09,696 - vector-persistence - INFO - Initializing Qdrant client at qdrant:6333
2026-01-08 11:17:22,865 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-08 11:17:22,866 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-08 11:17:25,276 - vector-persistence - INFO - Initializing Qdrant client at qdrant:6333
2026-01-08 11:17:25,332 - vector-persistence - INFO - Creating Qdrant collection: pdf_chunks
2026-01-08 11:19:36,153 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-08 11:19:36,153 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-08 11:19:38,893 - vector-persistence - INFO - Initializing Qdrant client at qdrant:6333
2026-01-08 11:19:53,770 - api-server - INFO - Processing request for: test1/statements_04.09.23.pdf
2026-01-08 11:19:53,771 - pdf-processor - INFO - Downloading statements_04.09.23.pdf from bucket test1...
2026-01-08 11:19:53,877 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/statements_04.09.23.pdf
2026-01-08 11:19:53,892 - persistence-service - INFO - Persisting data for statements_04.09.23.pdf from bucket test1...
2026-01-08 11:19:53,910 - persistence-service - ERROR - Database persistence error: 'TextDataPersistenceService' object has no attribute '_upsert_pdf'
2026-01-08 11:19:53,910 - pdf-processor - ERROR - Processing failed for test1/statements_04.09.23.pdf: 'TextDataPersistenceService' object has no attribute '_upsert_pdf'
2026-01-08 11:19:53,911 - api-server - ERROR - Internal server error: 'TextDataPersistenceService' object has no attribute '_upsert_pdf'
Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 111, in process_pdf
    persistence_result = self.persistence_service.save_pdf_data(bucket_name, object_name, metadata, chunks)
  File "/app/text_data_persistance_service.py", line 38, in save_pdf_data
    pdf_id = self._upsert_pdf(cur, bucket, filename)
AttributeError: 'TextDataPersistenceService' object has no attribute '_upsert_pdf'
2026-01-08 11:21:13,218 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-08 11:21:13,219 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-08 11:21:15,853 - vector-persistence - INFO - Initializing Qdrant client at qdrant:6333
2026-01-08 11:21:30,459 - api-server - INFO - Processing request for: test1/statements_04.09.23.pdf
2026-01-08 11:21:30,460 - pdf-processor - INFO - Downloading statements_04.09.23.pdf from bucket test1...
2026-01-08 11:21:30,491 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/statements_04.09.23.pdf
2026-01-08 11:21:30,503 - persistence-service - INFO - Persisting data for statements_04.09.23.pdf from bucket test1...
2026-01-08 11:21:30,585 - persistence-service - INFO - Successfully persisted PDF 256d92ed-2182-416a-8d59-6fda71835fda with 6 chunks.
2026-01-08 11:21:30,586 - vector-persistence - INFO - Generating embeddings for 6 chunks...
2026-01-08 11:21:31,139 - vector-persistence - INFO - Upserting 6 optimized points to Qdrant for PDF 256d92ed-2182-416a-8d59-6fda71835fda...
2026-01-08 11:21:31,202 - vector-persistence - INFO - Successfully upserted 6 points to Qdrant for PDF 256d92ed-2182-416a-8d59-6fda71835fda.
2026-01-08 13:05:19,965 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-08 13:05:19,966 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-08 13:05:22,403 - vector-persistence - INFO - Initializing Qdrant client at qdrant:6333
2026-01-08 13:07:16,240 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-08 13:07:16,241 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-08 13:07:18,772 - vector-persistence - INFO - Initializing Qdrant client at qdrant:6333
2026-01-08 13:07:18,813 - vector-persistence - INFO - Creating Qdrant collection: pdf_chunks
2026-01-08 13:15:18,547 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-08 13:15:18,548 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-08 13:15:21,278 - vector-persistence - INFO - Initializing Qdrant client at qdrant:6333
2026-01-08 13:16:06,948 - api-server - INFO - Processing request for: test1/drylab.pdf
2026-01-08 13:16:06,954 - pdf-processor - INFO - Downloading drylab.pdf from bucket test1...
2026-01-08 13:16:07,282 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/drylab.pdf
2026-01-08 13:16:07,327 - persistence-service - INFO - Persisting data for drylab.pdf from bucket test1...
2026-01-08 13:16:07,419 - persistence-service - INFO - Successfully persisted PDF a81d7302-399a-46e1-94ed-ce8711b8fae1 with 15 chunks.
2026-01-08 13:16:07,420 - vector-persistence - INFO - Generating embeddings for 15 chunks...
2026-01-08 13:16:08,776 - vector-persistence - INFO - Upserting 15 optimized points to Qdrant for PDF a81d7302-399a-46e1-94ed-ce8711b8fae1...
2026-01-08 13:16:08,974 - vector-persistence - INFO - Successfully upserted 15 points to Qdrant for PDF a81d7302-399a-46e1-94ed-ce8711b8fae1.
2026-01-08 13:52:18,541 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-08 13:52:18,545 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-08 13:52:21,671 - vector-persistence - INFO - Initializing Qdrant client at qdrant:6333
2026-01-08 13:53:31,655 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-08 13:53:31,656 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-08 13:53:34,013 - vector-persistence - INFO - Initializing Qdrant client at qdrant:6333
2026-01-08 14:23:48,952 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-08 14:23:48,953 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-08 14:23:51,539 - vector-persistence - INFO - Initializing Qdrant client at qdrant-pdf-vector-db:6333
2026-01-08 14:24:02,813 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-08 14:24:02,814 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-08 14:24:05,276 - vector-persistence - INFO - Initializing Qdrant client at qdrant-pdf-vector-db:6333
2026-01-08 15:14:03,274 - api-server - INFO - Processing request for: test1/magic.pdf
2026-01-08 15:14:03,276 - pdf-processor - INFO - Downloading magic.pdf from bucket test1...
2026-01-08 15:14:03,308 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/magic.pdf
2026-01-08 15:14:03,358 - persistence-service - INFO - Persisting data for magic.pdf from bucket test1...
2026-01-08 15:14:03,439 - persistence-service - INFO - Successfully persisted PDF ea815f43-0dc1-4cc3-a9c8-d225d89e2437 with 15 chunks.
2026-01-08 15:14:03,439 - vector-persistence - INFO - Generating embeddings for 15 chunks...
2026-01-08 15:14:04,582 - vector-persistence - INFO - Upserting 15 optimized points to Qdrant for PDF ea815f43-0dc1-4cc3-a9c8-d225d89e2437...
2026-01-08 15:14:04,623 - vector-persistence - INFO - Successfully upserted 15 points to Qdrant for PDF ea815f43-0dc1-4cc3-a9c8-d225d89e2437.
2026-01-08 15:21:08,629 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-08 15:21:08,630 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-08 15:21:11,114 - vector-persistence - INFO - Initializing Qdrant client at qdrant-pdf-vector-db:6333
2026-01-08 16:53:12,504 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-08 16:53:12,505 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-08 16:53:14,937 - vector-persistence - INFO - Initializing Qdrant client at qdrant-pdf-vector-db:6333
2026-01-08 16:53:32,273 - api-server - INFO - Processing request for: test1/drylab.pdf
2026-01-08 16:53:32,275 - pdf-processor - INFO - Downloading drylab.pdf from bucket test1...
2026-01-08 16:53:32,307 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/drylab.pdf
2026-01-08 16:53:32,334 - persistence-service - INFO - Persisting data for drylab.pdf from bucket test1...
2026-01-08 16:53:32,362 - persistence-service - INFO - Successfully persisted PDF d19f0bf7-55e4-4893-ab70-fb75779dfa7d with 15 chunks.
2026-01-08 16:53:32,362 - vector-persistence - INFO - Generating embeddings for 15 chunks...
2026-01-08 16:53:33,351 - vector-persistence - INFO - Upserting 15 optimized points to Qdrant for PDF d19f0bf7-55e4-4893-ab70-fb75779dfa7d...
2026-01-08 16:53:33,384 - vector-persistence - INFO - Successfully upserted 15 points to Qdrant for PDF d19f0bf7-55e4-4893-ab70-fb75779dfa7d.
2026-01-08 16:53:33,439 - api-server - INFO - Processing request for: test1/magic.pdf
2026-01-08 16:53:33,440 - pdf-processor - INFO - Downloading magic.pdf from bucket test1...
2026-01-08 16:53:33,447 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/magic.pdf
2026-01-08 16:53:33,477 - persistence-service - INFO - Persisting data for magic.pdf from bucket test1...
2026-01-08 16:53:33,490 - persistence-service - INFO - Successfully persisted PDF c408d002-babf-499a-9062-48a368e03172 with 15 chunks.
2026-01-08 16:53:33,492 - vector-persistence - INFO - Generating embeddings for 15 chunks...
2026-01-08 16:53:34,216 - vector-persistence - INFO - Upserting 15 optimized points to Qdrant for PDF c408d002-babf-499a-9062-48a368e03172...
2026-01-08 16:53:34,224 - vector-persistence - INFO - Successfully upserted 15 points to Qdrant for PDF c408d002-babf-499a-9062-48a368e03172.
2026-01-08 17:05:09,029 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-08 17:05:09,029 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-08 17:05:11,464 - vector-persistence - INFO - Initializing Qdrant client at qdrant-pdf-vector-db:6333
2026-01-08 17:16:56,399 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-08 17:16:56,399 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-08 17:16:58,950 - vector-persistence - INFO - Initializing Qdrant client at qdrant-pdf-vector-db:6333
2026-01-08 17:28:49,377 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-08 17:28:49,377 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-08 17:28:51,823 - vector-persistence - INFO - Initializing Qdrant client at qdrant-pdf-vector-db:6333
2026-01-08 17:38:11,353 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-08 17:38:11,353 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-08 17:38:13,695 - vector-persistence - INFO - Initializing Qdrant client at qdrant-pdf-vector-db:6333
2026-01-08 17:43:58,852 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-08 17:43:58,853 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-08 17:44:01,300 - vector-persistence - INFO - Initializing Qdrant client at qdrant-pdf-vector-db:6333
2026-01-08 17:44:01,344 - vector-persistence - INFO - Creating Qdrant collection: pdf_chunks
2026-01-08 17:58:12,445 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-08 17:58:12,446 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-08 17:58:15,013 - vector-persistence - INFO - Initializing Qdrant client at qdrant-pdf-vector-db:6333
2026-01-08 17:58:15,042 - vector-persistence - INFO - Creating Qdrant collection: pdf_chunks
2026-01-08 18:19:02,932 - api-server - INFO - Processing request for: test1/magic.pdf
2026-01-08 18:19:02,935 - pdf-processor - INFO - Downloading magic.pdf from bucket test1...
2026-01-08 18:19:02,963 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/magic.pdf
2026-01-08 18:19:03,011 - persistence-service - INFO - Persisting data for magic.pdf from bucket test1...
2026-01-08 18:19:03,038 - persistence-service - INFO - Successfully persisted PDF cca11aaf-013a-47d4-9eb8-9c28e02f87bb with 15 chunks.
2026-01-08 18:19:03,039 - vector-persistence - INFO - Generating embeddings for 15 chunks...
2026-01-08 18:19:04,161 - vector-persistence - INFO - Upserting 15 optimized points to Qdrant for PDF cca11aaf-013a-47d4-9eb8-9c28e02f87bb...
2026-01-08 18:19:04,202 - vector-persistence - INFO - Successfully upserted 15 points to Qdrant for PDF cca11aaf-013a-47d4-9eb8-9c28e02f87bb.
2026-01-08 18:19:51,247 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-08 18:19:51,247 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-08 18:19:54,031 - vector-persistence - INFO - Initializing Qdrant client at qdrant-pdf-vector-db:6333
2026-01-08 18:20:11,764 - api-server - INFO - Processing request for: test1/інструкція_сварочний.pdf
2026-01-08 18:20:11,766 - pdf-processor - INFO - Downloading інструкція_сварочний.pdf from bucket test1...
2026-01-08 18:20:11,804 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/інструкція_сварочний.pdf
2026-01-08 18:20:11,884 - persistence-service - INFO - Persisting data for інструкція_сварочний.pdf from bucket test1...
2026-01-08 18:20:11,921 - persistence-service - INFO - Successfully persisted PDF 98ce1484-2445-4972-b4be-cd40951044c3 with 79 chunks.
2026-01-08 18:20:11,921 - vector-persistence - INFO - Generating embeddings for 79 chunks...
2026-01-08 18:20:17,037 - vector-persistence - INFO - Upserting 79 optimized points to Qdrant for PDF 98ce1484-2445-4972-b4be-cd40951044c3...
2026-01-08 18:20:17,105 - vector-persistence - INFO - Successfully upserted 79 points to Qdrant for PDF 98ce1484-2445-4972-b4be-cd40951044c3.
2026-01-09 01:50:25,912 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-09 01:50:25,942 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-09 01:50:29,843 - vector-persistence - INFO - Initializing Qdrant client at qdrant-pdf-vector-db:6333
2026-01-09 01:51:52,010 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-09 01:51:52,016 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-09 01:52:03,629 - vector-persistence - INFO - Initializing Qdrant client at qdrant-pdf-vector-db:6333
2026-01-09 02:28:35,336 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-09 02:28:35,338 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-09 02:28:39,050 - vector-persistence - INFO - Initializing Qdrant client at qdrant-pdf-vector-db:6333
2026-01-09 03:02:53,669 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-09 03:02:53,675 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-09 03:02:56,964 - vector-persistence - INFO - Initializing Qdrant client at qdrant-pdf-vector-db:6333
2026-01-09 15:35:12,724 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-09 15:35:12,725 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-09 15:35:15,023 - vector-persistence - INFO - Initializing Qdrant client at qdrant-pdf-vector-db:6333
2026-01-09 15:36:47,452 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-09 15:36:47,453 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-09 15:36:49,901 - vector-persistence - INFO - Initializing Qdrant client at qdrant-pdf-vector-db:6333
2026-01-09 15:55:05,978 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-09 15:55:05,978 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-09 15:55:08,418 - vector-persistence - INFO - Initializing Qdrant client at qdrant-pdf-vector-db:6333
2026-01-09 15:58:14,743 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-09 15:58:14,743 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-09 15:58:17,028 - vector-persistence - INFO - Initializing Qdrant client at qdrant-pdf-vector-db:6333
2026-01-09 16:17:58,050 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-09 16:17:58,052 - vector-persistence - INFO - Initializing Embedding Model (SentenceTransformer)...
2026-01-09 16:18:00,737 - vector-persistence - INFO - Initializing Qdrant client at qdrant-pdf-vector-db:6333
2026-01-09 16:21:03,857 - api-server - INFO - Processing request for: sb1/drylab.pdf
2026-01-09 16:21:03,859 - pdf-processor - INFO - Downloading drylab.pdf from bucket sb1...
2026-01-09 16:21:03,897 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/drylab.pdf
2026-01-09 16:21:03,914 - persistence-service - INFO - Persisting data for drylab.pdf from bucket sb1...
2026-01-09 16:21:04,048 - persistence-service - INFO - Successfully persisted PDF ce54f1d2-165e-46cd-8472-340185440dc5 with 15 chunks.
2026-01-09 16:21:04,048 - vector-persistence - INFO - Generating embeddings for 15 chunks...
2026-01-09 16:21:05,318 - vector-persistence - INFO - Upserting 15 optimized points to Qdrant for PDF ce54f1d2-165e-46cd-8472-340185440dc5...
2026-01-09 16:21:05,366 - vector-persistence - INFO - Successfully upserted 15 points to Qdrant for PDF ce54f1d2-165e-46cd-8472-340185440dc5.
2026-01-10 13:45:30,662 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-10 13:55:11,843 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-10 14:02:18,461 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-10 14:09:57,861 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-10 14:14:12,548 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-10 15:10:04,843 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-10 15:11:48,039 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-10 15:15:59,367 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-10 15:16:58,619 - api-server - INFO - Processing request for: fin/інструкція_сварочний.pdf
2026-01-10 15:16:58,622 - pdf-processor - INFO - Downloading інструкція_сварочний.pdf from bucket fin...
2026-01-10 15:16:58,693 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/інструкція_сварочний.pdf
2026-01-10 15:16:58,767 - persistence-service - INFO - Persisting data for інструкція_сварочний.pdf from bucket fin...
2026-01-10 15:16:58,858 - persistence-service - INFO - Successfully persisted PDF a3b77741-bbef-4c69-bd16-a8ec3a151812 with 79 chunks.
2026-01-10 15:16:58,860 - api-server - INFO - Processing request for: fin/інструкція_сварочний.pdf
2026-01-10 15:16:58,860 - pdf-processor - INFO - Downloading інструкція_сварочний.pdf from bucket fin...
2026-01-10 15:16:58,867 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/інструкція_сварочний.pdf
2026-01-10 15:16:58,942 - persistence-service - INFO - Persisting data for інструкція_сварочний.pdf from bucket fin...
2026-01-10 15:16:58,959 - persistence-service - INFO - Successfully persisted PDF a3b77741-bbef-4c69-bd16-a8ec3a151812 with 79 chunks.
2026-01-10 15:20:03,503 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-10 15:20:27,270 - api-server - INFO - Processing request for: fin/інструкція_сварочний.pdf
2026-01-10 15:20:27,271 - pdf-processor - INFO - Downloading інструкція_сварочний.pdf from bucket fin...
2026-01-10 15:20:27,339 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/інструкція_сварочний.pdf
2026-01-10 15:20:27,411 - persistence-service - INFO - Persisting data for інструкція_сварочний.pdf from bucket fin...
2026-01-10 15:20:27,447 - persistence-service - INFO - Successfully persisted PDF b5e83539-e5dc-4a44-abd4-bb42e2d66192 with 79 chunks.
2026-01-10 15:21:28,502 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-10 15:28:46,465 - api-server - INFO - Processing request for: fin/test_new_file.pdf
2026-01-10 15:28:46,467 - pdf-processor - INFO - Downloading test_new_file.pdf from bucket fin...
2026-01-10 15:28:46,495 - pdf-processor - ERROR - Processing failed for fin/test_new_file.pdf: cannot open broken document
2026-01-10 15:28:46,496 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 95, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:29:03,237 - api-server - INFO - Processing request for: fin/test_new_file.pdf
2026-01-10 15:29:03,238 - pdf-processor - INFO - Downloading test_new_file.pdf from bucket fin...
2026-01-10 15:29:03,241 - pdf-processor - ERROR - Processing failed for fin/test_new_file.pdf: cannot open broken document
2026-01-10 15:29:03,241 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 95, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:30:03,426 - api-server - INFO - Processing request for: fin/test_new_file.pdf
2026-01-10 15:30:03,428 - pdf-processor - INFO - Downloading test_new_file.pdf from bucket fin...
2026-01-10 15:30:03,438 - pdf-processor - ERROR - Processing failed for fin/test_new_file.pdf: cannot open broken document
2026-01-10 15:30:03,439 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 95, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:31:03,631 - api-server - INFO - Processing request for: fin/test_new_file.pdf
2026-01-10 15:31:03,633 - pdf-processor - INFO - Downloading test_new_file.pdf from bucket fin...
2026-01-10 15:31:03,645 - pdf-processor - ERROR - Processing failed for fin/test_new_file.pdf: cannot open broken document
2026-01-10 15:31:03,646 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 95, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:31:38,862 - api-server - INFO - Processing request for: fin/test_new_file.pdf
2026-01-10 15:31:38,863 - pdf-processor - INFO - Downloading test_new_file.pdf from bucket fin...
2026-01-10 15:31:38,874 - pdf-processor - ERROR - Processing failed for fin/test_new_file.pdf: cannot open broken document
2026-01-10 15:31:38,874 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 95, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:32:03,709 - api-server - INFO - Processing request for: fin/test_new_file.pdf
2026-01-10 15:32:03,710 - pdf-processor - INFO - Downloading test_new_file.pdf from bucket fin...
2026-01-10 15:32:03,714 - pdf-processor - ERROR - Processing failed for fin/test_new_file.pdf: cannot open broken document
2026-01-10 15:32:03,714 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 95, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:33:03,841 - api-server - INFO - Processing request for: fin/test_new_file.pdf
2026-01-10 15:33:03,842 - pdf-processor - INFO - Downloading test_new_file.pdf from bucket fin...
2026-01-10 15:33:03,851 - pdf-processor - ERROR - Processing failed for fin/test_new_file.pdf: cannot open broken document
2026-01-10 15:33:03,851 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 95, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:34:02,910 - api-server - INFO - Processing request for: fin/test_new_file.pdf
2026-01-10 15:34:02,912 - pdf-processor - INFO - Downloading test_new_file.pdf from bucket fin...
2026-01-10 15:34:02,921 - pdf-processor - ERROR - Processing failed for fin/test_new_file.pdf: cannot open broken document
2026-01-10 15:34:02,921 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 95, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:35:03,028 - api-server - INFO - Processing request for: fin/test_new_file.pdf
2026-01-10 15:35:03,030 - pdf-processor - INFO - Downloading test_new_file.pdf from bucket fin...
2026-01-10 15:35:03,040 - pdf-processor - ERROR - Processing failed for fin/test_new_file.pdf: cannot open broken document
2026-01-10 15:35:03,040 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 95, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:36:04,178 - api-server - INFO - Processing request for: fin/test_new_file.pdf
2026-01-10 15:36:04,179 - pdf-processor - INFO - Downloading test_new_file.pdf from bucket fin...
2026-01-10 15:36:04,189 - pdf-processor - ERROR - Processing failed for fin/test_new_file.pdf: cannot open broken document
2026-01-10 15:36:04,189 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 95, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:37:04,315 - api-server - INFO - Processing request for: fin/test_new_file.pdf
2026-01-10 15:37:04,317 - pdf-processor - INFO - Downloading test_new_file.pdf from bucket fin...
2026-01-10 15:37:04,328 - pdf-processor - ERROR - Processing failed for fin/test_new_file.pdf: cannot open broken document
2026-01-10 15:37:04,328 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 95, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:38:03,405 - api-server - INFO - Processing request for: fin/test_new_file.pdf
2026-01-10 15:38:03,406 - pdf-processor - INFO - Downloading test_new_file.pdf from bucket fin...
2026-01-10 15:38:03,410 - pdf-processor - ERROR - Processing failed for fin/test_new_file.pdf: cannot open broken document
2026-01-10 15:38:03,410 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 95, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:39:03,598 - api-server - INFO - Processing request for: fin/test_new_file.pdf
2026-01-10 15:39:03,599 - pdf-processor - INFO - Downloading test_new_file.pdf from bucket fin...
2026-01-10 15:39:03,608 - pdf-processor - ERROR - Processing failed for fin/test_new_file.pdf: cannot open broken document
2026-01-10 15:39:03,608 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 95, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:39:55,352 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-10 15:40:18,638 - api-server - INFO - Processing request for: fin/test_new_file.pdf
2026-01-10 15:40:18,639 - pdf-processor - INFO - Downloading test_new_file.pdf from bucket fin...
2026-01-10 15:40:18,667 - pdf-processor - ERROR - Processing failed for fin/test_new_file.pdf: cannot open broken document
2026-01-10 15:40:18,667 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 95, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:40:18,674 - api-server - INFO - Processing request for: fin/інструкція_сварочний.pdf
2026-01-10 15:40:18,675 - pdf-processor - INFO - Downloading інструкція_сварочний.pdf from bucket fin...
2026-01-10 15:40:18,691 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/інструкція_сварочний.pdf
2026-01-10 15:40:18,765 - persistence-service - INFO - Persisting data for інструкція_сварочний.pdf from bucket fin...
2026-01-10 15:40:18,806 - persistence-service - INFO - Successfully persisted PDF 899d891c-6876-40a3-850e-f59f04ebd71c with 79 chunks.
2026-01-10 15:44:39,242 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-10 15:44:44,458 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 15:44:44,460 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 15:44:44,504 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 15:44:44,504 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 95, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:45:04,417 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 15:45:04,418 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 15:45:04,428 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 15:45:04,429 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 95, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:46:04,670 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 15:46:04,671 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 15:46:04,676 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 15:46:04,676 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 95, in process_pdf
    self.download_file(bucket_name, object_name, temp_pdf)
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:46:25,398 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-10 15:46:42,116 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 15:46:42,142 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 15:46:42,167 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 15:46:42,167 - persistence-service - INFO - Updating extraction status for a60895d7-f3e7-456c-9426-1804b4587c2a to 'failed'...
2026-01-10 15:46:42,182 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:47:03,475 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 15:47:03,488 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 15:47:03,491 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 15:47:03,492 - persistence-service - INFO - Updating extraction status for a60895d7-f3e7-456c-9426-1804b4587c2a to 'failed'...
2026-01-10 15:47:03,507 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:48:03,688 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 15:48:03,706 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 15:48:03,721 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 15:48:03,721 - persistence-service - INFO - Updating extraction status for a60895d7-f3e7-456c-9426-1804b4587c2a to 'failed'...
2026-01-10 15:48:03,732 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:49:03,852 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 15:49:03,867 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 15:49:03,875 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 15:49:03,875 - persistence-service - INFO - Updating extraction status for a60895d7-f3e7-456c-9426-1804b4587c2a to 'failed'...
2026-01-10 15:49:03,881 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:50:10,449 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-10 15:50:34,498 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 15:50:34,529 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 15:50:34,552 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 15:50:34,552 - persistence-service - INFO - Updating extraction status for a60895d7-f3e7-456c-9426-1804b4587c2a to 'failed'...
2026-01-10 15:50:34,566 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:51:04,396 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 15:51:04,409 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 15:51:04,413 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 15:51:04,413 - persistence-service - INFO - Updating extraction status for a60895d7-f3e7-456c-9426-1804b4587c2a to 'failed'...
2026-01-10 15:51:04,427 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:51:40,821 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-10 15:52:04,852 - api-server - INFO - Processing request for: fin/інструкція_сварочний.pdf
2026-01-10 15:52:04,876 - pdf-processor - INFO - Downloading інструкція_сварочний.pdf from bucket fin...
2026-01-10 15:52:04,957 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/інструкція_сварочний.pdf
2026-01-10 15:52:05,095 - persistence-service - INFO - Persisting metadata and chunks for PDF 785617c3-eb21-4802-8bf5-a3080ddd0f59...
2026-01-10 15:52:05,140 - persistence-service - INFO - Successfully persisted metadata and 79 chunks for PDF 785617c3-eb21-4802-8bf5-a3080ddd0f59.
2026-01-10 15:52:05,141 - persistence-service - INFO - Updating extraction status for 785617c3-eb21-4802-8bf5-a3080ddd0f59 to 'success'...
2026-01-10 15:52:05,174 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 15:52:05,189 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 15:52:05,193 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 15:52:05,193 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 15:52:05,201 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:53:03,760 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 15:53:03,780 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 15:53:03,790 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 15:53:03,790 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 15:53:03,805 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:54:04,144 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 15:54:04,157 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 15:54:04,166 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 15:54:04,166 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 15:54:04,177 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:55:04,133 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 15:55:04,151 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 15:55:04,160 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 15:55:04,160 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 15:55:04,172 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:56:04,376 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 15:56:04,396 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 15:56:04,406 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 15:56:04,407 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 15:56:04,415 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:57:03,566 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 15:57:03,586 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 15:57:03,594 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 15:57:03,594 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 15:57:03,606 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:58:03,862 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 15:58:03,885 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 15:58:03,894 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 15:58:03,894 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 15:58:03,904 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 15:59:03,968 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 15:59:03,984 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 15:59:03,988 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 15:59:03,988 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 15:59:04,001 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:00:04,036 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 16:00:04,061 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 16:00:04,071 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 16:00:04,071 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 16:00:04,086 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:01:04,226 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 16:01:04,240 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 16:01:04,244 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 16:01:04,245 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 16:01:04,250 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:02:04,412 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 16:02:04,431 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 16:02:04,439 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 16:02:04,439 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 16:02:04,452 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:03:03,558 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 16:03:03,576 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 16:03:03,584 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 16:03:03,584 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 16:03:03,598 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:04:03,882 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 16:04:03,900 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 16:04:03,911 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 16:04:03,911 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 16:04:03,926 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:05:04,085 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 16:05:04,099 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 16:05:04,110 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 16:05:04,111 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 16:05:04,118 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:06:03,232 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 16:06:03,250 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 16:06:03,259 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 16:06:03,259 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 16:06:03,272 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:07:03,490 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 16:07:03,507 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 16:07:03,516 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 16:07:03,516 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 16:07:03,524 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:08:03,714 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 16:08:03,731 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 16:08:03,747 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 16:08:03,748 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 16:08:03,756 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:09:03,890 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 16:09:03,911 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 16:09:03,921 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 16:09:03,921 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 16:09:03,936 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:10:03,981 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 16:10:03,996 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 16:10:04,005 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 16:10:04,005 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 16:10:04,011 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:11:03,101 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 16:11:03,113 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 16:11:03,118 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 16:11:03,118 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 16:11:03,126 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:12:03,224 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 16:12:03,238 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 16:12:03,244 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 16:12:03,244 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 16:12:03,253 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:13:02,332 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 16:13:02,347 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 16:13:02,350 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 16:13:02,351 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 16:13:02,363 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:14:02,583 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 16:14:02,601 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 16:14:02,609 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 16:14:02,609 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 16:14:02,622 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:15:02,729 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 16:15:02,744 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 16:15:02,748 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 16:15:02,748 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 16:15:02,759 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:16:02,845 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 16:16:02,859 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 16:16:02,866 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 16:16:02,866 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 16:16:02,871 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:17:02,942 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 16:17:02,960 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 16:17:02,967 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 16:17:02,967 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 16:17:02,982 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:18:04,140 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 16:18:04,154 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 16:18:04,159 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 16:18:04,159 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 16:18:04,171 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:19:04,311 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 16:19:04,329 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 16:19:04,342 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 16:19:04,342 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 16:19:04,352 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:20:04,509 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 16:20:04,539 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 16:20:04,552 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 16:20:04,553 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 16:20:04,561 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:23:03,653 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 16:23:03,672 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 16:23:03,681 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 16:23:03,681 - persistence-service - INFO - Updating extraction status for ad6fc9ed-776d-4e44-9368-6ed4f9ed2ec2 to 'failed'...
2026-01-10 16:23:03,702 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:23:54,880 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-10 16:24:20,516 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-10 16:24:20,554 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-10 16:24:20,579 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-10 16:24:20,579 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-10 16:24:20,591 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-10 16:24:20,617 - api-server - INFO - Processing request for: fin/інструкція_сварочний.pdf
2026-01-10 16:24:20,628 - pdf-processor - INFO - Downloading інструкція_сварочний.pdf from bucket fin...
2026-01-10 16:24:20,655 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/інструкція_сварочний.pdf
2026-01-10 16:24:20,750 - persistence-service - INFO - Persisting metadata and chunks for PDF cff81134-88ec-4cee-bf03-5fc22b1f9245...
2026-01-10 16:24:20,770 - persistence-service - INFO - Successfully persisted metadata and 79 chunks for PDF cff81134-88ec-4cee-bf03-5fc22b1f9245.
2026-01-10 16:24:20,770 - persistence-service - INFO - Updating extraction status for cff81134-88ec-4cee-bf03-5fc22b1f9245 to 'success'...
2026-01-11 14:05:04,147 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-11 14:05:28,850 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:05:28,877 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:05:28,897 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:05:28,897 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:05:28,908 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:06:03,600 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:06:03,612 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:06:03,616 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:06:03,617 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:06:03,627 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:13:32,602 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:13:32,613 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:13:32,623 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:13:32,623 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:13:32,631 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:14:03,837 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:14:03,845 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:14:03,849 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:14:03,849 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:14:03,854 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:15:04,049 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:15:04,060 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:15:04,066 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:15:04,066 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:15:04,071 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:16:03,202 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:16:03,210 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:16:03,213 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:16:03,213 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:16:03,219 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:17:03,429 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:17:03,439 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:17:03,445 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:17:03,446 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:17:03,453 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:18:03,668 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:18:03,681 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:18:03,684 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:18:03,685 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:18:03,697 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:19:03,790 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:19:03,802 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:19:03,806 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:19:03,806 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:19:03,818 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:20:03,903 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:20:03,919 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:20:03,924 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:20:03,924 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:20:04,167 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:21:02,931 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:21:02,945 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:21:02,949 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:21:02,949 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:21:02,961 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:22:03,116 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:22:03,129 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:22:03,133 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:22:03,133 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:22:03,145 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:23:03,385 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:23:03,397 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:23:03,401 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:23:03,401 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:23:03,412 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:24:03,657 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:24:03,671 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:24:03,676 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:24:03,677 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:24:03,685 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:25:03,859 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:25:03,875 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:25:03,881 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:25:03,881 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:25:03,886 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:26:03,483 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:26:03,497 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:26:03,500 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:26:03,500 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:26:03,512 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:27:03,661 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:27:03,675 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:27:03,679 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:27:03,679 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:27:03,691 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:28:03,912 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:28:03,926 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:28:03,929 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:28:03,929 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:28:03,942 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:29:04,152 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:29:04,165 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:29:04,170 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:29:04,170 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:29:04,180 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:30:04,387 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:30:04,403 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:30:04,421 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:30:04,422 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:30:04,432 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:31:03,502 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:31:03,513 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:31:03,518 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:31:03,519 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:31:03,524 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:32:03,816 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:32:03,826 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:32:03,829 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:32:03,830 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:32:03,839 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:33:04,037 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:33:04,051 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:33:04,054 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:33:04,055 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:33:04,067 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:34:04,245 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:34:04,259 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:34:04,263 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:34:04,263 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:34:04,276 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:35:03,405 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:35:03,413 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:35:03,416 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:35:03,416 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:35:03,422 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:36:03,707 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:36:03,721 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:36:03,727 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:36:03,727 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:36:03,733 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:37:03,930 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:37:03,941 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:37:03,945 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:37:03,945 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:37:03,950 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:38:04,153 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:38:04,164 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:38:04,167 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:38:04,167 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:38:04,180 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:39:04,385 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:39:04,399 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:39:04,402 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:39:04,402 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:39:04,414 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:40:03,576 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:40:03,591 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:40:03,596 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:40:03,596 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:40:03,601 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:41:03,700 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:41:03,713 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:41:03,716 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:41:03,717 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:41:03,728 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:42:03,924 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:42:03,937 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:42:03,941 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:42:03,941 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:42:03,953 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:43:04,175 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:43:04,191 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:43:04,194 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:43:04,194 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:43:04,206 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:44:04,410 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:44:04,423 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:44:04,426 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:44:04,427 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:44:04,439 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:45:03,636 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:45:03,647 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:45:03,650 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:45:03,651 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:45:03,655 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:46:03,778 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:46:03,798 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:46:03,802 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:46:03,804 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:46:03,823 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:47:03,954 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:47:03,964 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:47:03,970 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:47:03,970 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:47:03,977 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:48:04,250 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:48:04,262 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:48:04,264 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:48:04,265 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:48:04,270 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:49:03,501 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:49:03,514 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:49:03,520 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:49:03,520 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:49:03,535 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:50:03,690 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:50:03,703 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:50:03,707 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:50:03,707 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:50:03,719 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:51:03,875 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:51:03,889 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:51:03,895 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:51:03,895 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:51:03,908 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:52:04,057 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:52:04,072 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:52:04,075 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:52:04,076 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:52:04,087 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:53:04,310 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:53:04,325 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:53:04,328 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:53:04,328 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:53:04,342 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:54:03,437 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:54:03,453 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:54:03,457 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:54:03,457 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:54:03,467 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:55:03,737 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:55:03,747 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:55:03,751 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:55:03,751 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:55:03,759 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:56:02,885 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:56:02,896 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:56:02,899 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:56:02,899 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:56:02,907 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:57:02,990 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:57:03,005 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:57:03,010 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:57:03,011 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:57:03,023 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:58:03,127 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:58:03,141 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:58:03,145 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:58:03,145 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:58:03,157 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 14:59:03,334 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 14:59:03,345 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 14:59:03,348 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 14:59:03,348 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 14:59:03,358 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 15:00:03,551 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 15:00:03,567 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 15:00:03,571 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 15:00:03,571 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 15:00:03,580 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 15:01:03,794 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 15:01:03,809 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 15:01:03,812 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 15:01:03,813 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 15:01:03,823 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 15:02:04,049 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 15:02:04,061 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 15:02:04,066 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 15:02:04,066 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 15:02:04,071 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 15:03:03,191 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 15:03:03,200 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 15:03:03,204 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 15:03:03,204 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 15:03:03,225 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 15:04:03,456 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 15:04:03,471 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 15:04:03,474 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 15:04:03,475 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 15:04:03,488 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 15:05:03,556 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 15:05:03,571 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 15:05:03,577 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 15:05:03,577 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 15:05:03,586 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 15:06:03,912 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 15:06:03,922 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 15:06:03,926 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 15:06:03,926 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 15:06:03,935 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    with fitz.open(temp_pdf) as doc:
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 15:07:04,062 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 15:07:04,076 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 15:07:04,079 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 15:07:04,079 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 15:07:04,091 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    return pdf_id
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 15:08:04,222 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 15:08:04,232 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 15:08:04,236 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 15:08:04,236 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 15:08:04,247 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    return pdf_id
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 15:09:03,373 - api-server - INFO - Processing request for: fin/corrupt_test.pdf
2026-01-11 15:09:03,386 - pdf-processor - INFO - Downloading corrupt_test.pdf from bucket fin...
2026-01-11 15:09:03,390 - pdf-processor - ERROR - Processing failed for fin/corrupt_test.pdf: cannot open broken document
2026-01-11 15:09:03,390 - persistence-service - INFO - Updating extraction status for edca0567-35b0-4fe2-a420-aeca47c6e5aa to 'failed'...
2026-01-11 15:09:03,400 - api-server - ERROR - Internal server error: cannot open broken document
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2659, in __init__
    self.this = extra.Document_init( filename, stream, filetype, rect, width, height, fontsize)
  File "/usr/local/lib/python3.10/site-packages/fitz/extra.py", line 153, in Document_init
    return _extra.Document_init(filename, stream, filetype, rect, width, height, fontsize)
RuntimeError: code=0: no objects found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/main.py", line 59, in process_file
    result = pdf_processor.process_pdf(
  File "/app/processor.py", line 98, in process_pdf
    return pdf_id
  File "/usr/local/lib/python3.10/site-packages/fitz/__init__.py", line 2666, in __init__
    raise FileDataError( MSG_BAD_DOCUMENT) from e
fitz.FileDataError: cannot open broken document
2026-01-11 15:11:35,539 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-11 15:11:59,593 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-11 15:12:24,736 - api-server - INFO - Processing request for: fin/інструкція_сварочний.pdf
2026-01-11 15:12:24,759 - persistence-service - INFO - Acquiring advisory lock for fin/інструкція_сварочний.pdf (ID: -7768723087133970906)
2026-01-11 15:12:24,769 - pdf-processor - INFO - Downloading інструкція_сварочний.pdf from bucket fin...
2026-01-11 15:12:24,818 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/інструкція_сварочний.pdf
2026-01-11 15:12:24,889 - persistence-service - INFO - Persisting metadata and chunks for PDF d1e8209a-427d-43e2-91fa-ca1b6bed27e0...
2026-01-11 15:12:24,930 - persistence-service - INFO - Successfully persisted metadata and 79 chunks for PDF d1e8209a-427d-43e2-91fa-ca1b6bed27e0.
2026-01-11 15:12:24,930 - persistence-service - INFO - Updating extraction status for d1e8209a-427d-43e2-91fa-ca1b6bed27e0 to 'success'...
2026-01-11 15:38:07,001 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-11 15:38:31,186 - api-server - INFO - Processing request for: fin/інструкція_сварочний.pdf
2026-01-11 15:38:31,194 - persistence-service - INFO - Acquiring advisory lock for fin/інструкція_сварочний.pdf (ID: -7768723087133970906)
2026-01-11 15:38:31,201 - pdf-processor - INFO - Downloading інструкція_сварочний.pdf from bucket fin...
2026-01-11 15:38:31,232 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/інструкція_сварочний.pdf
2026-01-11 15:38:31,301 - persistence-service - INFO - Persisting metadata and chunks for PDF 0d2243b3-d1ae-40ac-885b-4bd1c3a55ca8...
2026-01-11 15:38:31,324 - persistence-service - INFO - Successfully persisted metadata and 79 chunks for PDF 0d2243b3-d1ae-40ac-885b-4bd1c3a55ca8.
2026-01-11 15:38:31,324 - persistence-service - INFO - Updating extraction status for 0d2243b3-d1ae-40ac-885b-4bd1c3a55ca8 to 'success'...
2026-01-11 15:40:57,212 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-11 15:48:42,826 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-11 15:51:03,888 - api-server - INFO - Processing request for: fin/інструкція_сварочний.pdf
2026-01-11 15:51:03,896 - persistence-service - INFO - Acquiring advisory lock for fin/інструкція_сварочний.pdf (ID: -7768723087133970906)
2026-01-11 15:51:03,906 - pdf-processor - INFO - Downloading інструкція_сварочний.pdf from bucket fin...
2026-01-11 15:51:03,927 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/інструкція_сварочний.pdf
2026-01-11 15:51:03,995 - persistence-service - INFO - Persisting metadata and chunks for PDF 0cecd092-122b-4321-8ec3-e5c0369233d0...
2026-01-11 15:51:04,015 - persistence-service - INFO - Successfully persisted metadata and 79 chunks for PDF 0cecd092-122b-4321-8ec3-e5c0369233d0.
2026-01-11 15:51:04,016 - persistence-service - INFO - Updating extraction status for 0cecd092-122b-4321-8ec3-e5c0369233d0 to 'success'...
2026-01-11 16:12:00,777 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-11 16:21:03,616 - api-server - INFO - Processing request for: fin/інструкція_сварочний.pdf
2026-01-11 16:21:03,624 - persistence-service - INFO - Acquiring advisory lock for fin/інструкція_сварочний.pdf (ID: -7768723087133970906)
2026-01-11 16:21:03,630 - pdf-processor - INFO - Downloading інструкція_сварочний.pdf from bucket fin...
2026-01-11 16:21:03,664 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/інструкція_сварочний.pdf
2026-01-11 16:21:03,734 - persistence-service - INFO - Persisting metadata and chunks for PDF df8a9dcc-6da3-4c59-8212-1c05ace62a8c...
2026-01-11 16:21:03,777 - persistence-service - INFO - Successfully persisted metadata and 79 chunks for PDF df8a9dcc-6da3-4c59-8212-1c05ace62a8c.
2026-01-11 16:21:03,777 - persistence-service - INFO - Updating extraction status for df8a9dcc-6da3-4c59-8212-1c05ace62a8c to 'success'...
2026-01-11 16:33:04,063 - api-server - INFO - Processing request for: fin/інструкція_сварочний.pdf
2026-01-11 16:33:04,071 - persistence-service - INFO - Acquiring advisory lock for fin/інструкція_сварочний.pdf (ID: -7768723087133970906)
2026-01-11 16:33:04,089 - pdf-processor - INFO - Downloading інструкція_сварочний.pdf from bucket fin...
2026-01-11 16:33:04,119 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/інструкція_сварочний.pdf
2026-01-11 16:33:04,183 - persistence-service - INFO - Persisting metadata and chunks for PDF daaab170-8aea-4d15-b7c8-92d1ebd40262...
2026-01-11 16:33:04,212 - persistence-service - INFO - Successfully persisted metadata and 79 chunks for PDF daaab170-8aea-4d15-b7c8-92d1ebd40262.
2026-01-11 16:33:04,212 - persistence-service - INFO - Updating extraction status for daaab170-8aea-4d15-b7c8-92d1ebd40262 to 'success'...
2026-01-11 16:42:02,236 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-11 16:42:26,414 - api-server - INFO - Processing request for: fin/інструкція_сварочний.pdf
2026-01-11 16:42:26,422 - persistence-service - INFO - Acquiring advisory lock for fin/інструкція_сварочний.pdf (ID: -7768723087133970906)
2026-01-11 16:42:26,431 - pdf-processor - INFO - Downloading інструкція_сварочний.pdf from bucket fin...
2026-01-11 16:42:26,452 - pdf-processor - INFO - Extracting and chunking PDF: /tmp/інструкція_сварочний.pdf
2026-01-11 16:42:26,521 - persistence-service - INFO - Persisting metadata and chunks for PDF e7e1e6b2-f9bf-49bd-b5e2-0aa01c6e0828...
2026-01-11 16:42:26,545 - persistence-service - INFO - Successfully persisted metadata and 79 chunks for PDF e7e1e6b2-f9bf-49bd-b5e2-0aa01c6e0828.
2026-01-11 16:42:26,545 - persistence-service - INFO - Updating extraction status for e7e1e6b2-f9bf-49bd-b5e2-0aa01c6e0828 to 'success'...
2026-01-11 16:58:18,833 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-11 17:59:43,677 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-11 18:03:44,651 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-11 18:06:34,983 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-11 18:14:03,066 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
2026-01-11 18:37:46,583 - pdf-processor - INFO - Initializing MinIO client connection to minio:9000
